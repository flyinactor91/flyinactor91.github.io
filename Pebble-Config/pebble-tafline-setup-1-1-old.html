<!DOCTYPE html>
<html lang="en" xmlns="http://mdupont.com">

<head>
    <!--META-->
    <title>TAFline Config 1.1</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--LINK-->
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />

    <!--SCRIPT-->
    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
</head>

<body>

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5B6F45" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5B6F45');</script>
    <!-- End Google Tag Manager -->

    <div data-role="page" id="main">
        <div data-role="header" class="jqm-header">
            <h1>TAFline Config</h1>
        </div>

        <div data-role="content">

            <!--<div data-role="fieldcontain">
                <label for="name">Name:</label>
                <textarea cols="40" rows="8" name="name" id="name"></textarea>
            </div>

            <div data-role="fieldcontain">
                <label for="special-feature">Activate special feature:</label>
                <select name="special-feature" id="special-feature" data-role="slider">
                    <option value="off">Off</option>
                    <option value="on">On</option>
                </select>
            </div>

            <div data-role="fieldcontain">
                <fieldset data-role="controlgroup">
                    <legend>Choose as many snacks as you'd like:</legend>
                    <input type="checkbox" name="checkbox-cheetos" id="checkbox-cheetos" class="custom" />
                    <label for="checkbox-cheetos">Cheetos</label>

                    <input type="checkbox" name="checkbox-doritos" id="checkbox-doritos" class="custom" />
                    <label for="checkbox-doritos">Doritos</label>

                    <input type="checkbox" name="checkbox-fritos" id="checkbox-fritos" class="custom" />
                    <label for="checkbox-fritos">Fritos</label>

                    <input type="checkbox" name="checkbox-sunchips" id="checkbox-sunchips" class="custom" />
                    <label for="checkbox-sunchips">Sun Chips</label>
                </fieldset>
            </div>-->
            
            <div>
                <p>More projects: mdupont.com</p>
                <p>Source Code: github.com/flyinactor91/TAFline</p>
                <p>Get some value? Give some back.</p>
				<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
				</form>
            </div>
            
            <div data-role="fieldcontain">
                <label for="stationID">Station ID (KJFK):</label>
                <textarea cols="40" rows="8" name="stationID" id="stationID"></textarea>
            </div>
            
            <div data-role="fieldcontain">
                <label for="getNearest">Use Nearest (requires location):</label>
                <select name="getNearest" id="getNearest" data-role="slider">
                    <option value="off">Off</option>
                    <option value="on">On</option>
                </select>
            </div>
            
            <div data-role="fieldcontain">
                <label for="translate">Translate:</label>
                <select name="translate" id="translate" data-role="slider">
                    <option value="off">Off</option>
                    <option value="on">On</option>
                </select>
            </div>
            
            <div>
                <p>Restart TAFline for the changes to take effect. You will need to reenter an option if you select cancel or close the page. JavaScript must be enabled in your phone's browser.</p>
            </div>

        </div>

        <div class="ui-body ui-body-b">
            <fieldset class="ui-grid-a">
                <div class="ui-block-a"><button type="submit" data-theme="d" id="b-cancel">Cancel</button></div>
                <div class="ui-block-b"><button type="submit" data-theme="a" id="b-submit">Save</button></div>
            </fieldset>
        </div>
    </div>

    <script>
        function onoffBool(onoff) {
            if (onoff == "on") { return true; }
            return false;
        }
        
        function sanitizeID(id) {
            if (id.length > 4) { id = id.substring(0,4); }
            id = id.toUpperCase();
            return id;
        }
        
        function saveOptions() {
            var options = {
                'stationID': sanitizeID($("#stationID").val()),
                'getNearest': onoffBool($("#getNearest").val()),
                'translate': onoffBool($("#translate").val())
            };
            console.log(JSON.stringify(options))
            return options;
        }

        $().ready(function() {
            $("#b-cancel").click(function() {
                console.log("Cancel");
                document.location = "pebblejs://close";
            });

            $("#b-submit").click(function() {
                console.log("Submit");

                var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(saveOptions()));
                console.log("Warping to: " + location);
                console.log(location);
                document.location = location;
            });

        });
    </script>
</body>

</html>
